# 7.3.1: Role-based access tests

**Status:** BACKLOG
**Type:** Story
**Feature:** [7.3: Authorization Scenario Tests](./7.3-authorization-tests.md)
**Tags:** `+testing` `+auth`

---

As a QA engineer,
I want automated tests that exercise every role's allowed and denied operations,
So that no code change can silently grant a restricted persona access they should not have.

## Acceptance Criteria

- [ ] For each tool that has role restrictions, at least one test calls it as a persona that **should be denied** and asserts the correct MCP authorization error
- [ ] For each tool that has role restrictions, at least one test calls it as a persona that **should succeed** and asserts a valid (non-error) response
- [ ] Tests are written using `[Theory]` with `[MemberData]` so adding a new role or tool only requires updating the data source, not adding new test methods
- [ ] The following high-value deny cases are explicitly covered:
  - Intern (`VinnyGambini`) cannot call `intake_approve`
  - Associate (`KimWexler`) cannot call `billing_get_summary` (no billing access for associates)
  - Paralegal (`ErinBrockovich`) cannot call `invoices_get`
  - LegalAssistant (`ElleWoods`) cannot call `research_search_precedents`
  - OfCounsel (`AlanShore`) cannot call `intake_create_request`
- [ ] The following allow cases are explicitly covered:
  - Partner (`HarveySpecter`) can call every tool
  - Associate (`KimWexler`) can call `cases_get` for Case Alpha (assigned)
  - Associate (`KimWexler`) can call `research_search_precedents`

## Notes

Use `LawCorpWebApplicationFactory.CreateAuthenticatedClient(FirmPersona.X)` to set the acting persona for each test.
Map tool names to HTTP routes once the Web API routing is established in Epic 3 and 1.1.2.
