# 7.4.1: Case management & document tool tests

**Status:** BACKLOG
**Type:** Story
**Feature:** [7.4: Tool E2E Tests](./7.4-tool-e2e-tests.md)
**Tags:** `+testing` `+case-mgmt` `+doc-mgmt`

---

As a QA engineer,
I want E2E tests for the case management and document tools,
So that the most-used MCP capabilities are verified to work correctly for authorized personas and fail correctly for unauthorized ones.

## Tools Covered

`cases_search`, `cases_get`, `cases_update_status`, `cases_assign_attorney`, `cases_get_timeline`, `cases_add_note`, `documents_search`, `documents_get`, `documents_draft`, `documents_update_status`, `documents_list_by_case`

## Acceptance Criteria

- [ ] `cases_search` as `HarveySpecter` returns Case Alpha and Case Beta; as `AlanShore` returns only Case Gamma
- [ ] `cases_get` as `KimWexler` for Case Alpha returns full case details; for Case Beta returns not-found
- [ ] `cases_update_status` as `KimWexler` on Case Alpha succeeds (assigned); as `ErinBrockovich` returns authorization error (read-only)
- [ ] `cases_assign_attorney` as `HarveySpecter` succeeds; as `KimWexler` returns authorization error (Associate cannot assign)
- [ ] `cases_add_note` as `HarveySpecter` with `isPrivileged=true` succeeds; the note does not appear for `VinnyGambini` in subsequent `cases_get`
- [ ] `documents_search` as `KimWexler` scoped to Case Alpha returns the privileged document metadata (with access); content is returned unredacted
- [ ] `documents_get` as `VinnyGambini` for document 4001 returns redacted content (covered in depth by 7.3.3 but smoke-tested here)
- [ ] `documents_draft` as `ErinBrockovich` on Case Alpha succeeds (Paralegal can draft on assigned cases)
- [ ] `documents_list_by_case` for Case Alpha as `AlanShore` returns authorization error (different practice group, no assignment)
