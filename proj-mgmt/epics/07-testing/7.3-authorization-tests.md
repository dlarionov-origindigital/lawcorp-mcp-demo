# 7.3: Authorization Scenario Tests

**Status:** BACKLOG
**Epic:** [Epic 7: End-to-End Testing](./_epic.md)
**Goal:** Verify that the authorization model from PRD Section 4.2 is fully enforced: role-based access denies the right personas, row-level security prevents cross-scope data leakage, field-level redaction strips privileged content for restricted roles, and identity passthrough drives correct access boundaries across all downstream resources ([ADR-005](../../decisions/005-oauth-identity-passthrough.md)).

## Items

| ID | Title | Type | Status |
|---|---|---|---|
| [7.3.1](./7.3.1-role-access-tests.md) | Role-based access tests | Story | BACKLOG |
| [7.3.2](./7.3.2-row-level-security-tests.md) | Row-level security tests | Story | BACKLOG |
| [7.3.3](./7.3.3-field-redaction-tests.md) | Field redaction tests | Story | BACKLOG |
| [7.3.4](./7.3.4-identity-passthrough-tests.md) | Identity passthrough authorization tests | Story | BACKLOG |

## Acceptance Criteria

- [ ] Every (role × entity type × operation) combination from PRD Table 4.2 has at least one test
- [ ] Each test is parameterized with the persona enum — no copy-paste per role
- [ ] Denied access results in the correct MCP error response (not an unhandled exception)
- [ ] Row-level tests confirm the denied persona receives an empty result set (not a 403) where the PRD specifies filtering rather than rejection
- [ ] Redaction tests confirm exact field values are `null` or replaced with a sentinel string for the Intern persona
- [ ] Identity passthrough tests verify that Graph-backed and local DB-backed resources both enforce per-persona access boundaries
- [ ] Consent-required scenarios return structured MCP errors, not unhandled exceptions

## Dependencies

Depends on: 7.1 (test infrastructure), 7.2 (persona fixture), 1.3.1–1.3.3 (auth handlers), 1.2.4 (downstream resource access)
