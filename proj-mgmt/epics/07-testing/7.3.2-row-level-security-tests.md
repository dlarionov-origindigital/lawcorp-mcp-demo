# 7.3.2: Row-level security tests

**Status:** BACKLOG
**Type:** Story
**Feature:** [7.3: Authorization Scenario Tests](./7.3-authorization-tests.md)
**Tags:** `+testing` `+auth`

---

As a QA engineer,
I want tests that prove row-level security silently scopes query results to the requesting persona's access boundary,
So that a restricted user never receives entities they are not authorised to see, even if they know the entity ID.

## Acceptance Criteria

- [ ] **Associate scope**: `KimWexler` calling `cases_search` returns Case Alpha but NOT Case Beta (assigned to Harvey only) and NOT Case Gamma (different practice group)
- [ ] **Associate direct fetch**: `KimWexler` calling `cases_get` with Case Beta's ID returns an empty/not-found response, not a 403 (the PRD scopes by assignment, so the row is invisible, not forbidden)
- [ ] **OfCounsel practice group scope**: `AlanShore` calling `cases_search` returns Case Gamma but not Case Alpha or Case Beta
- [ ] **Paralegal scope**: `ErinBrockovich` calling `cases_search` returns Case Alpha (assigned) but not Case Beta or Case Gamma
- [ ] **LegalAssistant scope**: `ElleWoods` calling `cases_search` returns Case Alpha and Case Beta (Harvey's cases) but not Case Gamma
- [ ] **Partner full access**: `HarveySpecter` calling `cases_search` returns all three cases in the M&A practice group
- [ ] **Document scope**: `ErinBrockovich` calling `documents_list_by_case` for Case Alpha returns the privileged document in the result set (Paralegal has read access); `AlanShore` does not (different practice group, no assignment)

## Notes

Row-level security is enforced by EF Core global query filters (story 1.3.2). These tests validate that the filters are correctly applied end-to-end, not just in unit tests of the filter expressions.

Each test should inspect the `items` array in the MCP tool response and check case IDs present or absent â€” do not rely on count alone.
