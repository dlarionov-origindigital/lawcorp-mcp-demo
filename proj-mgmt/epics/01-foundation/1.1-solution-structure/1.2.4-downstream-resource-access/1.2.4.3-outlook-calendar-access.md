# 1.2.4.3: Outlook calendar access via user identity

**Status:** BACKLOG
**Type:** Task
**Story:** [1.2.4: Downstream resource access](./1.2.4-downstream-resource-access.md)
**Tags:** `+auth` `+foundation` `+calendar`

---

Implement a service that reads and manages Outlook calendar events using the calling user's delegated identity, demonstrating that the MCP server accesses only calendar data the user owns or has been delegated access to.

## Implementation Steps

- [ ] Create `IOutlookCalendarService` interface in `LawCorp.Mcp.Core` with methods for listing events, getting event details, creating events, and checking availability
- [ ] Implement `GraphOutlookCalendarService : IOutlookCalendarService` in `LawCorp.Mcp.Server` using `GraphServiceClient` (from 1.2.4.1) to call `/me/calendar/events`, `/me/calendarView`, and `/users/{id}/calendar` (for delegated access)
- [ ] Required Graph scopes: `Calendars.Read`, `Calendars.ReadWrite` (for event creation)
- [ ] For LegalAssistant role: use delegated calendar access — Elle Woods reads Harvey Specter's calendar via `/users/{harveyId}/calendar` (requires `Calendars.Read.Shared` or equivalent)
- [ ] Register `IOutlookCalendarService` as scoped in DI
- [ ] Wire into the `calendar_get_hearings`, `calendar_get_deadlines`, `calendar_add_event`, and `calendar_get_conflicts` MCP tools (Epic 3, Feature 3.5) as a supplemental source beyond the local DB

## Acceptance Criteria

- [ ] A user can read their own calendar events via MCP tools
- [ ] A LegalAssistant (Elle Woods) can read their assigned attorney's (Harvey Specter's) calendar
- [ ] An Intern (Vinny Gambini) can only read their own schedule
- [ ] Calendar write operations (add event) respect the user's write permissions
- [ ] Unauthorized calendar access returns a structured MCP error response

## Persona Verification

| Persona | Expected Behavior |
|---|---|
| Harvey Specter (Partner) | Full read/write to own calendar |
| Elle Woods (LegalAssistant) | Read Harvey's calendar + own calendar; create events on own calendar |
| Vinny Gambini (Intern) | Own schedule only |

## Notes

Depends on 1.2.4.1 (Graph client with OBO provider).
Delegated calendar access (reading another user's calendar) requires that the target user has granted calendar sharing permissions in Outlook. This is a data setup concern, not a code concern — document the required sharing configuration in the setup guide (1.2.3).
