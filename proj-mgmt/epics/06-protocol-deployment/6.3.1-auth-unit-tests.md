# 6.3.1: Write unit tests for authorization layer

**Status:** BACKLOG
**Type:** Story
**Feature:** [6.3: Testing](./6.3-testing.md)
**Tags:** `+protocol` `+auth`

---

As a developer,
I want comprehensive unit tests for the authorization layer,
So that role-based access is verified before deployment.

- [ ] Test each role (Partner, Associate, OfCounsel, Paralegal, LegalAssistant, Intern) against each entity type (cases, documents, billing, etc.)
- [ ] Test row-level filtering for each role (e.g., associates only see assigned cases)
- [ ] Test field-level redaction for Intern role
- [ ] Test authorization handler edge cases: no role claim, multiple roles, expired claims

## Acceptance Criteria

- [ ] Every role Ã— entity combination has at least one test
- [ ] Row-level filter tests verify the correct WHERE clause is applied
- [ ] Field-redaction tests verify sensitive fields are null/omitted for Intern
- [ ] Edge case tests cover no-role, multi-role, and expired-token scenarios
- [ ] All tests pass in CI without external dependencies
