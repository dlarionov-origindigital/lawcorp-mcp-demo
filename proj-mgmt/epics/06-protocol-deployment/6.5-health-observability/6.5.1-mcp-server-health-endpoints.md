# 6.5.1: MCP Server Health Endpoints

**Status:** BACKLOG
**Type:** Story
**Feature:** [6.5 Health Checks & Observability](./6.5-health-observability.md)

## Goal

Add ASP.NET Core health check endpoints to the MCP Server so Azure App Service and load balancers can monitor instance health.

## Acceptance Criteria

- [ ] `Microsoft.Extensions.Diagnostics.HealthChecks` added to the MCP Server project
- [ ] `/health` endpoint returns 200 OK (liveness — process is alive)
- [ ] `/health/ready` endpoint checks SQL Server (`LawCorpLocal`) connectivity
- [ ] `/health/ready` endpoint checks External API (`http://localhost:5002/health`) reachability
- [ ] Health endpoints are unauthenticated (no JWT required)
- [ ] Health endpoints return standard ASP.NET Core health check response format
- [ ] Works in both HTTP transport mode and is skipped in stdio mode

## Tasks

1. Register `AddHealthChecks()` with SQL Server and URI checks in `ServerBootstrap.RunHttpAsync()`
2. Map `/health` and `/health/ready` endpoints
3. Ensure health check middleware runs before auth middleware
4. Add tests for both healthy and unhealthy states

## References

- [Health checks in ASP.NET Core — Microsoft Learn](https://learn.microsoft.com/en-us/aspnet/core/host-and-deploy/health-checks)
- [Monitor App Service instances using health check — Microsoft Learn](https://learn.microsoft.com/en-us/azure/app-service/monitor-instances-health-check)
