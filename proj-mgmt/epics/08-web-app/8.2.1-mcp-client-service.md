# 8.2.1: MCP client service with HttpClientTransport

**Status:** DONE
**Type:** Story
**Feature:** [8.2: MCP Client Integration](./8.2-mcp-client-integration.md)
**Tags:** `+web-app` `+mcp-client`

---

As a developer building the Blazor web app,
I want a reusable MCP client service that connects to the Law-Corp MCP server via HTTP,
So that all Blazor components can invoke tools, read resources, and use prompts through a shared abstraction.

## Implementation Steps

- [ ] Create `IMcpClientService` interface in the web app project with methods:
  - `Task<IList<McpClientTool>> ListToolsAsync()`
  - `Task<CallToolResponse> CallToolAsync(string toolName, object arguments)`
  - `Task<IList<McpClientResource>> ListResourcesAsync()`
  - `Task<ReadResourceResponse> ReadResourceAsync(string uri)`
  - `Task<IList<McpClientPrompt>> ListPromptsAsync()`
  - `Task<GetPromptResponse> GetPromptAsync(string promptName, object arguments)`
  - `McpClientState State { get; }` (Connecting, Ready, Failed)
- [ ] Implement `McpClientService : IMcpClientService` using:
  - `HttpClientTransport` with configurable endpoint URL (`McpServer:Endpoint` config key)
  - `McpClientFactory.CreateAsync(transport)` to establish the connection
  - Automatic reconnection on transport failure
- [ ] Register `IMcpClientService` as **scoped** in DI (one per user session in Interactive Server mode)
- [ ] Add configuration section to `appsettings.json`:
  ```json
  { "McpServer": { "Endpoint": "http://localhost:5000/mcp" } }
  ```
- [ ] Add health check: verify MCP server is reachable on startup or first connection attempt

## Acceptance Criteria

- [ ] `IMcpClientService` can list tools from the connected MCP server
- [ ] `CallToolAsync` returns the MCP server's response for a valid tool call
- [ ] Connection failures produce a clear error state (not an unhandled exception)
- [ ] The service reconnects automatically if the transport drops

## Notes

Token passthrough is handled in [8.2.2](./8.2.2-session-token-passthrough.md). This task establishes the transport plumbing; 8.2.2 adds the auth header.
