# 8.6.1: Sign-in link navigates to authentication

**Status:** IN PROGRESS
**Type:** Story
**Feature:** [8.6: Header Links](./8.6-header-links.md)
**Tags:** `+web-app` `+auth` `+header` `+e2e`

---

As a visitor on any page with the header visible in an unauthenticated state,
I want to click the sign-in link and be taken to the Entra ID authentication page,
So that I can log in and access identity-scoped MCP features.

## Preconditions

- `UseAuth=true` in app configuration
- Microsoft Identity Web UI controllers are registered
- The Entra ID app registration has `https://localhost:5001/signin-oidc` as a redirect URI

## Happy Path

```
1. User visits any page (e.g. /)
2. Header shows "Sign in" button (user is not authenticated)
3. User clicks "Sign in"
4. Browser navigates to /MicrosoftIdentity/Account/SignIn
5. Server issues OIDC challenge → redirects to login.microsoftonline.com
6. User completes Entra ID login
7. Redirect back to app with session established
8. Header now shows persona avatar + name + "Sign out" button
```

## Tasks

| ID | Title | Status |
|---|---|---|
| 8.6.1.1 | Guard sign-in link visibility behind `UseAuth` config check | DONE |
| 8.6.1.2 | Show "Demo mode" badge in header when `UseAuth=false` | DONE |
| 8.6.1.3 | Show contextual info banner on home page when `UseAuth=false` | DONE |
| 8.6.1.4 | Playwright E2E: anonymous user sees sign-in button (`UseAuth=true`) | IN PROGRESS |
| 8.6.1.5 | Playwright E2E: sign-in link redirects to Entra ID login | IN PROGRESS |

## Acceptance Criteria

- [ ] When `UseAuth=true` and user is anonymous, header shows "Sign in" button
- [ ] Clicking "Sign in" navigates to `/MicrosoftIdentity/Account/SignIn` (not 404)
- [ ] The OIDC challenge redirects to `login.microsoftonline.com`
- [ ] When `UseAuth=false`, header shows "Demo mode" badge instead of sign-in link
- [ ] Home page shows contextual message when auth is disabled
- [ ] Playwright E2E test validates the complete sign-in link → redirect flow

## Related

- **Bug:** [BUG-001](./BUG-001-sign-in-link-404.md) — the 404 that prompted this story
- **Depends on:** [8.1.2](../8.1.2-entra-id-oidc-auth/8.1.2-entra-id-oidc-auth.md) — OIDC auth configuration
